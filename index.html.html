<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A&amp;P Practice Test</title>
  <style>
    :root { --bg:#0b1020; --card:#121a33; --text:#e9ecff; --muted:#b7c0ff; --good:#26d07c; --bad:#ff4d4d; --line:#26305a; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:linear-gradient(180deg,#060a16, var(--bg)); color:var(--text); }
    .wrap { max-width: 980px; margin: 0 auto; padding: 22px 14px 80px; }
    h1 { margin: 6px 0 4px; font-size: 22px; }
    .sub { color: var(--muted); font-size: 14px; margin-bottom: 14px; line-height: 1.35; }
    .bar { position: sticky; top: 0; z-index: 20; background: rgba(6,10,22,.9); backdrop-filter: blur(6px); border-bottom: 1px solid var(--line); padding: 10px 0; }
    .bar-inner { display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .btn { background: #2a3cff; color: white; border: 0; padding: 10px 14px; border-radius: 10px; font-weight: 700; cursor: pointer; }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    .btn.secondary { background: transparent; border: 1px solid var(--line); color: var(--text); }
    .pill { border:1px solid var(--line); padding: 8px 10px; border-radius: 999px; color: var(--muted); font-size: 13px; }
    .card { background: rgba(18,26,51,.85); border: 1px solid var(--line); border-radius: 14px; padding: 14px; margin: 12px 0; }
    .qhead { display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .qnum { font-weight: 800; }
    .cat { color: var(--muted); font-size: 12px; border:1px solid var(--line); padding: 4px 8px; border-radius: 999px; }
    .qtext { margin: 8px 0 10px; line-height: 1.35; }
    .choices { display:grid; gap: 8px; }
    label.choice {
      display:flex; align-items:flex-start; gap:10px;
      border: 1px solid var(--line); border-radius: 12px; padding: 10px;
      cursor:pointer; background: rgba(10,14,28,.35);
    }
    label.choice:hover { background: rgba(10,14,28,.55); }
    input[type="radio"] { margin-top: 2px; transform: scale(1.1); }
    .after { display:none; margin-top: 10px; border-top: 1px dashed var(--line); padding-top: 10px; }
    .status { font-weight: 800; }
    .status.good { color: var(--good); }
    .status.bad { color: var(--bad); }
    .explain { color: var(--muted); margin-top: 6px; line-height: 1.35; }
    .correct { color: var(--good); font-weight: 800; }
    .results { display:none; }
    .grid2 { display:grid; gap:10px; grid-template-columns: 1fr; }
    @media (min-width: 760px){ .grid2 { grid-template-columns: 1fr 1fr; } }
    .mini { color: var(--muted); font-size: 13px; line-height: 1.35; }
    .missed { margin-top: 12px; }
    .missed li { margin: 6px 0; color: var(--muted); }
  </style>
</head>
<body id="top">
  <div class="bar">
    <div class="wrap">
      <div class="bar-inner">
        <div class="pill" id="progressPill">Progress: 0 / 100 answered</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;">
          <button class="btn secondary" id="resetBtn" type="button">Reset</button>
          <button class="btn" id="submitBtn" type="button">Submit (anytime)</button>
        </div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <h1>A&amp;P Practice Test</h1>
    <div class="sub">
      100 multiple-choice questions. Submit whenever. Unanswered = incorrect.
      Explanations appear only after you submit.
    </div>

    <div class="card results" id="resultsCard" aria-live="polite">
      <div class="grid2">
        <div>
          <div style="font-size:18px; font-weight:900;">Score: <span id="scoreText">0</span> / 100</div>
          <div class="mini" id="breakdownText"></div>
        </div>
        <div>
          <div class="mini"><b>Note:</b> If you submit early, unanswered are marked incorrect.</div>
          <div class="mini" style="margin-top:6px;"><a href="#top" style="color:#9fb0ff; text-decoration:none;">Jump back to top</a></div>
        </div>
      </div>
      <div class="missed">
        <div style="margin-top:10px; font-weight:900;">Missed / Unanswered:</div>
        <ul id="missedList"></ul>
      </div>
    </div>

    <div id="quiz"></div>

    <div class="mini" style="margin-top:18px;">
      GitHub Pages tip: name the file <b>index.html</b>.
    </div>
  </div>

<script>
const BASE_QUESTIONS = [
  // (same question bank style; we will hard-force exactly 100 below)

  {category:"Directional terms", q:"Which term means 'toward the head'?", choices:["Inferior","Medial","Superior","Distal"], answerIndex:2, explanation:"Superior = toward the head; inferior = toward the feet."},
  {category:"Directional terms", q:"The elbow is ____ to the wrist.", choices:["Proximal","Distal","Superficial","Lateral"], answerIndex:0, explanation:"Proximal = closer to the trunk/attachment point."},

  {category:"Planes & cavities", q:"A sagittal plane divides the body into:", choices:["Front/back","Left/right","Top/bottom","Inside/outside"], answerIndex:1, explanation:"Sagittal = left and right portions."},
  {category:"Planes & cavities", q:"The lungs are located in the ____ cavity.", choices:["Cranial","Thoracic","Abdominal","Pelvic"], answerIndex:1, explanation:"Lungs are in the thoracic cavity."},

  {category:"Organization", q:"Correct order from simplest to most complex is:", choices:["Organ → cell → tissue → system","Cell → tissue → organ → system","Tissue → cell → organ → system","Cell → organ → tissue → system"], answerIndex:1, explanation:"Cells → tissues → organs → organ systems."},

  {category:"Homeostasis", q:"Homeostasis is best described as:", choices:["Stable internal conditions","Constant body motion","Growing new cells","Making hormones"], answerIndex:0, explanation:"Homeostasis = stable internal environment."},

  {category:"Cells", q:"The main control center of the cell is the:", choices:["Ribosome","Nucleus","Lysosome","Cell membrane"], answerIndex:1, explanation:"The nucleus contains DNA and directs cell activity."},
  {category:"Cells", q:"Ribosomes primarily make:", choices:["Lipids","ATP","Proteins","DNA"], answerIndex:2, explanation:"Ribosomes are the site of protein synthesis."},

  {category:"Membrane transport", q:"Water moving across a membrane is called:", choices:["Diffusion","Osmosis","Endocytosis","Filtration"], answerIndex:1, explanation:"Osmosis = diffusion of water."},
  {category:"Membrane transport", q:"Moving a substance from low to high concentration requires:", choices:["Passive transport","Active transport","Osmosis","Simple diffusion"], answerIndex:1, explanation:"Active transport uses energy to go against the gradient."},

  {category:"Cell division", q:"Mitosis produces:", choices:["2 identical cells","4 identical cells","2 different gametes","4 different gametes"], answerIndex:0, explanation:"Mitosis makes 2 genetically identical cells."},
  {category:"Cell division", q:"Meiosis is used to make:", choices:["Skin cells","Red blood cells","Gametes (sperm/egg)","Muscle fibers"], answerIndex:2, explanation:"Meiosis makes haploid gametes."},

  {category:"Tissues", q:"The tissue type that lines organs and body surfaces is:", choices:["Muscle","Epithelial","Nervous","Connective"], answerIndex:1, explanation:"Epithelial tissue covers/lines and forms glands."},
  {category:"Tissues", q:"Blood is a type of:", choices:["Connective tissue","Epithelial tissue","Nervous tissue","Smooth muscle"], answerIndex:0, explanation:"Blood is classified as connective tissue."},

  {category:"Integumentary", q:"The outermost layer of the skin is the:", choices:["Dermis","Hypodermis","Epidermis","Periosteum"], answerIndex:2, explanation:"Epidermis is the outer layer."},

  {category:"Bone basics", q:"The tough outer covering of bone is the:", choices:["Cartilage","Periosteum","Tendon","Myelin"], answerIndex:1, explanation:"Periosteum covers bone."},

  {category:"Skeleton", q:"The axial skeleton includes the:", choices:["Skull, vertebral column, rib cage","Arms and legs","Shoulder and hip bones only","Hands and feet only"], answerIndex:0, explanation:"Axial = skull, spine, rib cage."},
  {category:"Skeleton", q:"The appendicular skeleton includes:", choices:["Skull and ribs","Vertebrae only","Limbs and girdles","Sternum only"], answerIndex:2, explanation:"Appendicular = limbs plus girdles."},

  {category:"Joints", q:"A hinge joint is found at the:", choices:["Shoulder","Hip","Knee","Neck"], answerIndex:2, explanation:"Knee (and elbow) are hinge joints."},

  {category:"Bone remodeling", q:"Cells that build bone are called:", choices:["Osteoclasts","Osteoblasts","Neurons","Erythrocytes"], answerIndex:1, explanation:"Osteoblasts build; osteoclasts break down."},

  {category:"Muscle anatomy", q:"A tendon attaches:", choices:["Bone to bone","Muscle to bone","Nerve to muscle","Skin to muscle"], answerIndex:1, explanation:"Tendons connect muscle to bone."},

  {category:"Muscle contraction", q:"The neurotransmitter at the neuromuscular junction is:", choices:["Dopamine","Acetylcholine","Serotonin","Epinephrine"], answerIndex:1, explanation:"Skeletal muscle NMJ uses acetylcholine."},

  {category:"Muscle types", q:"Smooth muscle is found in:", choices:["Biceps","Heart","Intestines","Tongue"], answerIndex:2, explanation:"Smooth muscle lines hollow organs (GI, vessels)."},
  {category:"Muscle types", q:"Cardiac muscle is:", choices:["Voluntary","Involuntary and striated","Voluntary and smooth","Only found in limbs"], answerIndex:1, explanation:"Cardiac = involuntary, striated."},

  {category:"Nervous tissue", q:"Cells that support and protect neurons are:", choices:["Glia (neuroglia)","Platelets","Osteocytes","Adipocytes"], answerIndex:0, explanation:"Glia support neurons."},

  {category:"Neuron anatomy", q:"The part of a neuron that receives signals is mostly the:", choices:["Axon","Dendrites","Myelin","Synaptic cleft"], answerIndex:1, explanation:"Dendrites receive input."},

  {category:"Neurophysiology", q:"During depolarization, a neuron membrane becomes:", choices:["More negative inside","More positive inside","Unchanged","Unable to conduct"], answerIndex:1, explanation:"Na+ influx makes inside more positive."},

  {category:"Synapses", q:"Neurotransmitters cross the:", choices:["Myelin sheath","Nucleus","Synaptic cleft","Cell wall"], answerIndex:2, explanation:"They diffuse across the synaptic cleft."},

  {category:"CNS", q:"The central nervous system consists of:", choices:["Brain and spinal cord","Nerves and ganglia","Heart and lungs","Bones and muscles"], answerIndex:0, explanation:"CNS = brain + spinal cord."},

  {category:"PNS", q:"The peripheral nervous system is mainly:", choices:["Brain tissue","Spinal cord","Nerves outside CNS","Only cranial nerves"], answerIndex:2, explanation:"PNS = nerves outside CNS."},

  {category:"ANS", q:"The 'fight or flight' division is the:", choices:["Parasympathetic","Sympathetic","Somatic","Central"], answerIndex:1, explanation:"Sympathetic = fight/flight."},

  {category:"Cranial nerves", q:"The optic nerve (CN II) is mainly for:", choices:["Smell","Vision","Hearing","Taste"], answerIndex:1, explanation:"CN II carries vision information."},

  {category:"Endocrine", q:"The pancreas helps regulate blood sugar by releasing:", choices:["Insulin and glucagon","Bile and pepsin","ADH and oxytocin","Epinephrine only"], answerIndex:0, explanation:"Insulin lowers glucose; glucagon raises it."},

  {category:"Hormones", q:"Steroid hormones can pass through membranes because they are:", choices:["Water-soluble","Lipid-soluble","Always proteins","Always stored in vesicles"], answerIndex:1, explanation:"Steroids are lipid-soluble and cross membranes."},

  {category:"Blood", q:"Red blood cells mainly carry:", choices:["Oxygen","Hormones","Antibodies","Bile"], answerIndex:0, explanation:"RBCs carry O2 via hemoglobin."},

  {category:"Clotting", q:"Platelets are most involved in:", choices:["Oxygen transport","Clot formation","Breaking down fats","Nerve impulses"], answerIndex:1, explanation:"Platelets help form clots."},

  {category:"Heart anatomy", q:"The chamber that pumps blood to the lungs is the:", choices:["Left atrium","Left ventricle","Right ventricle","Right atrium"], answerIndex:2, explanation:"Right ventricle pumps to pulmonary circulation."},

  {category:"Cardiac conduction", q:"The normal pacemaker of the heart is the:", choices:["AV node","SA node","Purkinje fibers","Bundle branches"], answerIndex:1, explanation:"SA node sets normal rhythm."},

  {category:"Cardiac cycle", q:"Systole refers to:", choices:["Relaxation phase","Contraction phase","Blood clotting","Gas exchange"], answerIndex:1, explanation:"Systole = contraction."},

  {category:"Vessels", q:"Arteries generally carry blood:", choices:["Toward the heart","Away from the heart","Only oxygen-poor","Only in the lungs"], answerIndex:1, explanation:"Arteries carry blood away from the heart."},

  {category:"Blood pressure", q:"Blood pressure is typically highest in the:", choices:["Veins","Capillaries","Arteries","Venules"], answerIndex:2, explanation:"Arteries have the highest pressure."},

  {category:"Lymphatic", q:"The lymphatic system helps mainly with:", choices:["Digestion","Immune defense and fluid return","Bone growth","Vision"], answerIndex:1, explanation:"It returns fluid and supports immunity."},

  {category:"Immunity", q:"Antibodies are produced by:", choices:["Red blood cells","B cells (plasma cells)","Platelets","Neurons"], answerIndex:1, explanation:"Plasma cells (from B cells) make antibodies."},

  {category:"Respiratory", q:"The windpipe is the:", choices:["Esophagus","Trachea","Bronchiole","Alveolus"], answerIndex:1, explanation:"Trachea = windpipe."},

  {category:"Respiratory", q:"Gas exchange happens in the:", choices:["Larynx","Trachea","Alveoli","Diaphragm"], answerIndex:2, explanation:"Alveoli are the exchange sacs."},

  {category:"Breathing mechanics", q:"The primary muscle of inspiration is the:", choices:["Diaphragm","Biceps","Trapezius","Rectus femoris"], answerIndex:0, explanation:"Diaphragm contraction draws air in."},

  {category:"Gas exchange", q:"Oxygen moves from alveoli to blood mainly by:", choices:["Active transport","Diffusion","Osmosis","Endocytosis"], answerIndex:1, explanation:"Gases move by diffusion."},

  {category:"Gas transport", q:"Most oxygen in blood is carried by:", choices:["Plasma water","Hemoglobin","Platelets","White blood cells"], answerIndex:1, explanation:"Hemoglobin carries most O2."},

  {category:"Acid-base", q:"A normal blood pH is around:", choices:["5.0","6.8","7.4","8.6"], answerIndex:2, explanation:"Normal arterial pH is about 7.4."},

  {category:"Digestive", q:"The first part of the small intestine is the:", choices:["Ileum","Jejunum","Duodenum","Cecum"], answerIndex:2, explanation:"Duodenum comes first."},

  {category:"Digestive", q:"Which is an accessory digestive organ?", choices:["Stomach","Small intestine","Liver","Esophagus"], answerIndex:2, explanation:"Accessory organs include liver, pancreas, gallbladder."},

  {category:"Digestion/absorption", q:"Most nutrient absorption occurs in the:", choices:["Stomach","Small intestine","Esophagus","Large intestine"], answerIndex:1, explanation:"Small intestine does most absorption."},

  {category:"Liver & bile", q:"Bile helps digest:", choices:["Proteins","Carbohydrates","Fats","DNA"], answerIndex:2, explanation:"Bile emulsifies fats."},

  {category:"Metabolism", q:"ATP is best described as the cell’s:", choices:["Waste product","Energy currency","Genetic code","Hormone"], answerIndex:1, explanation:"ATP stores/transfers usable energy."},

  {category:"Urinary", q:"The ureters carry urine from the:", choices:["Bladder to outside","Kidneys to bladder","Urethra to bladder","Blood to kidneys"], answerIndex:1, explanation:"Ureters: kidneys → bladder."},

  {category:"Nephron", q:"The functional unit of the kidney is the:", choices:["Alveolus","Neuron","Nephron","Sarcomere"], answerIndex:2, explanation:"Nephron filters blood and forms urine."},

  {category:"Urine formation", q:"The first step of urine formation is:", choices:["Reabsorption","Filtration","Secretion","Excretion"], answerIndex:1, explanation:"Glomerular filtration happens first."},

  {category:"Fluids/electrolytes", q:"ADH causes the kidneys to:", choices:["Excrete more water","Retain more water","Stop filtering blood","Make bile"], answerIndex:1, explanation:"ADH increases water reabsorption."},

  {category:"Reproduction", q:"Sperm are produced in the:", choices:["Prostate","Testes","Vas deferens","Urethra"], answerIndex:1, explanation:"Sperm form in the testes."},

  {category:"Reproduction", q:"Ovulation releases an egg from the:", choices:["Uterus","Cervix","Ovary","Vagina"], answerIndex:2, explanation:"Ovulation releases an egg from an ovary."},

  {category:"Gametogenesis", q:"Gametes (sperm/egg) are typically:", choices:["Diploid (2n)","Haploid (n)","Triploid","Always identical"], answerIndex:1, explanation:"Gametes are haploid."},

  {category:"Development", q:"A zygote is:", choices:["A mature sperm","A fertilized egg","A fetal organ","A hormone"], answerIndex:1, explanation:"Zygote = fertilized egg."},

  {category:"Pregnancy", q:"The placenta mainly allows:", choices:["Bone growth","Exchange of nutrients and wastes","Blood clotting only","Vision"], answerIndex:1, explanation:"Placenta is an exchange organ."},

  {category:"Genetics", q:"DNA’s main role is to:", choices:["Store genetic information","Make bile","Carry oxygen","Pump blood"], answerIndex:0, explanation:"DNA stores genetic instructions."},

  {category:"Inflammation", q:"A common sign of inflammation is:", choices:["Cold skin","Redness and swelling","Low blood sugar","Blindness"], answerIndex:1, explanation:"Inflammation often causes redness, swelling, pain, heat."},

  {category:"Infection", q:"Bacteria are best described as:", choices:["Multicellular animals","Single-celled prokaryotes","Viruses with DNA only","Human cells"], answerIndex:1, explanation:"Bacteria are single-celled prokaryotes."},

  {category:"Shock", q:"Shock is generally a problem of:", choices:["Too much oxygen in blood","Poor tissue perfusion","Too much bone growth","Too much digestion"], answerIndex:1, explanation:"Shock = inadequate perfusion/oxygen delivery."},

  {category:"Trauma", q:"In major bleeding, the most immediate life threat is often:", choices:["Fever","Loss of perfusion/oxygen delivery","High blood sugar","Ear pain"], answerIndex:1, explanation:"Hemorrhage reduces perfusion quickly."},

  {category:"Aging", q:"A common normal aging change is:", choices:["Increased bone density","Decreased skin elasticity","Faster healing","More alveoli"], answerIndex:1, explanation:"Skin becomes less elastic with age."},

  // Extra easy mixed bank (we will slice to exactly 100)
  {category:"Directional terms", q:"The skin is ____ to the muscles.", choices:["Deep","Superficial","Distal","Inferior"], answerIndex:1, explanation:"Superficial = closer to the surface."},
  {category:"Planes & cavities", q:"A transverse plane divides the body into:", choices:["Left/right","Front/back","Top/bottom","Inside/outside"], answerIndex:2, explanation:"Transverse = top and bottom."},
  {category:"Homeostasis", q:"Negative feedback usually:", choices:["Amplifies a change","Reverses a change to restore normal","Has no effect","Only occurs in disease"], answerIndex:1, explanation:"Negative feedback counters change."},
  {category:"Cells", q:"Mitochondria mainly produce:", choices:["ATP","DNA","Hormones","Bile"], answerIndex:0, explanation:"Mitochondria are major ATP producers."},
  {category:"Membrane transport", q:"Simple diffusion moves substances:", choices:["Against gradient using ATP","Down gradient without ATP","Only through pumps","Only water"], answerIndex:1, explanation:"Diffusion is passive down a gradient."},
  {category:"Cell division", q:"Meiosis results in cells with:", choices:["Same chromosomes as parent","Half the chromosomes","Double the chromosomes","No DNA"], answerIndex:1, explanation:"Meiosis makes haploid cells."},
  {category:"Tissues", q:"Connective tissue generally:", choices:["Conducts impulses","Contracts","Supports and binds","Forms the skin surface"], answerIndex:2, explanation:"Connective tissue supports/binds (bone, cartilage, blood)."},
  {category:"Integumentary", q:"Melanin mainly affects:", choices:["Skin color & UV protection","Blood pressure","Heart rate","Urine formation"], answerIndex:0, explanation:"Melanin helps protect from UV and affects pigmentation."},
  {category:"Bone basics", q:"Bone stores minerals like:", choices:["Sodium & chlorine","Calcium & phosphorus","Iron & iodine","Helium & neon"], answerIndex:1, explanation:"Bone stores calcium and phosphate."},
  {category:"Joints", q:"A pivot joint is found in the:", choices:["Neck (atlas/axis)","Knee","Hip","Ankle"], answerIndex:0, explanation:"Atlas/axis allows head rotation."},
  {category:"Bone remodeling", q:"Cells that break down bone are:", choices:["Osteoblasts","Osteoclasts","Myocytes","Fibroblasts"], answerIndex:1, explanation:"Osteoclasts resorb bone."},
  {category:"Muscle anatomy", q:"Ligaments attach:", choices:["Muscle to bone","Bone to bone","Skin to bone","Nerve to bone"], answerIndex:1, explanation:"Ligaments connect bone to bone."},
  {category:"Muscle contraction", q:"The functional unit of a muscle fiber is the:", choices:["Sarcomere","Neuron","Alveolus","Nephron"], answerIndex:0, explanation:"Sarcomere is the contractile unit."},
  {category:"Muscle types", q:"Which muscle type is voluntary?", choices:["Cardiac","Smooth","Skeletal","None"], answerIndex:2, explanation:"Skeletal muscle is voluntary."},
  {category:"Nervous tissue", q:"Myelin mainly:", choices:["Speeds nerve conduction","Makes RBCs","Digests fats","Clots blood"], answerIndex:0, explanation:"Myelin insulates axons and speeds conduction."},
  {category:"Neuron anatomy", q:"The axon carries impulses:", choices:["Toward the cell body","Away from the cell body","Only within dendrites","Only in the nucleus"], answerIndex:1, explanation:"Axons transmit signals away from soma."},
  {category:"Neurophysiology", q:"Repolarization commonly involves:", choices:["Na+ entering","K+ leaving","Ca2+ entering","Glucose entering"], answerIndex:1, explanation:"K+ efflux helps repolarize."},
  {category:"Synapses", q:"An excitatory input makes a neuron:", choices:["Less likely to fire","More likely to fire","Unable to respond","Turn into muscle"], answerIndex:1, explanation:"Excitatory input helps reach threshold."},
  {category:"CNS", q:"The spinal cord mainly:", choices:["Produces hormones","Relays signals & mediates reflexes","Digests food","Stores bile"], answerIndex:1, explanation:"Spinal cord relays signals and supports reflexes."},
  {category:"PNS", q:"Somatic motor nerves control:", choices:["Skeletal muscle","Heart muscle","Sweat glands","Digestion"], answerIndex:0, explanation:"Somatic motor = voluntary skeletal muscle."},
  {category:"ANS", q:"Parasympathetic activity tends to:", choices:["Increase heart rate","Decrease digestion","Promote rest & digestion","Stop urine formation"], answerIndex:2, explanation:"Parasympathetic = rest/digest."},
  {category:"Cranial nerves", q:"CN I is mainly for:", choices:["Smell","Hearing","Vision","Balance"], answerIndex:0, explanation:"CN I (olfactory) = smell."},
  {category:"Endocrine", q:"The thyroid mainly helps regulate:", choices:["Metabolism","Blood clotting","Bone length only","Vision"], answerIndex:0, explanation:"Thyroid hormones regulate metabolic rate."},
  {category:"Hormones", q:"Insulin generally:", choices:["Raises blood glucose","Lowers blood glucose","Stops digestion","Clots blood"], answerIndex:1, explanation:"Insulin lowers blood glucose by promoting uptake/storage."},
  {category:"Blood", q:"White blood cells are mainly for:", choices:["Carrying oxygen","Immune defense","Clotting","Carrying bile"], answerIndex:1, explanation:"WBCs defend against infection."},
  {category:"Clotting", q:"Vitamin K is important for:", choices:["Vision","Clotting factor production","Bone lengthening","Hearing"], answerIndex:1, explanation:"Vitamin K helps make certain clotting factors."},
  {category:"Heart anatomy", q:"The valve between left atrium and left ventricle is the:", choices:["Tricuspid","Mitral (bicuspid)","Pulmonary","Aortic"], answerIndex:1, explanation:"Mitral valve separates LA and LV."},
  {category:"Cardiac conduction", q:"The AV node mainly:", choices:["Starts the heartbeat","Delays impulse to ventricles","Carries oxygen","Makes hormones"], answerIndex:1, explanation:"AV node delay lets atria empty first."},
  {category:"Cardiac cycle", q:"Diastole refers to:", choices:["Contraction","Relaxation/filling","Clotting","Gas exchange"], answerIndex:1, explanation:"Diastole is relaxation and filling."},
  {category:"Vessels", q:"Capillaries are important because they:", choices:["Have valves","Are exchange sites","Have thick muscle walls","Carry blood away from heart"], answerIndex:1, explanation:"Capillaries allow exchange of gases/nutrients/wastes."},
  {category:"Blood pressure", q:"Blood pressure is written as:", choices:["O2/CO2","Systolic/diastolic","HR/RR","pH/HCO3"], answerIndex:1, explanation:"BP = systolic over diastolic."},
  {category:"Lymphatic", q:"Lymph nodes mainly:", choices:["Pump blood","Filter lymph & house immune cells","Make ATP","Produce bile"], answerIndex:1, explanation:"Nodes filter lymph and support immune response."},
  {category:"Immunity", q:"A vaccine works mainly by:", choices:["Causing dehydration","Training immune memory","Destroying bones","Lowering pH always"], answerIndex:1, explanation:"Vaccines build immune memory."},
  {category:"Respiratory", q:"The epiglottis helps prevent:", choices:["Food entering trachea","Air entering lungs","Blood clotting","Urine formation"], answerIndex:0, explanation:"Epiglottis covers airway during swallowing."},
  {category:"Digestive", q:"The esophagus mainly:", choices:["Absorbs nutrients","Moves food to stomach","Makes bile","Filters blood"], answerIndex:1, explanation:"Esophagus transports food."},
  {category:"Urinary", q:"The bladder stores:", choices:["Bile","Urine","CSF","Synovial fluid"], answerIndex:1, explanation:"Bladder stores urine."},
  {category:"Directional terms", q:"The heart is ____ to the lungs.", choices:["Lateral","Medial","Distal","Superficial"], answerIndex:1, explanation:"Heart is closer to the midline than the lungs."},
  {category:"Cells", q:"The cell membrane is mainly a:", choices:["Phospholipid bilayer","Bone matrix","Cartilage ring","DNA coil"], answerIndex:0, explanation:"Cell membrane is mostly phospholipid bilayer + proteins."},
  {category:"Blood", q:"Hemoglobin is found in:", choices:["White blood cells","Red blood cells","Platelets","Plasma only"], answerIndex:1, explanation:"Hemoglobin is inside RBCs."},
  {category:"Respiratory", q:"The larynx is commonly called the:", choices:["Voice box","Windpipe","Food pipe","Air sac"], answerIndex:0, explanation:"Larynx = voice box."},
  {category:"Digestive", q:"Peristalsis is:", choices:["Muscle waves that move food","Air exchange","Bone growth","Clot breakdown"], answerIndex:0, explanation:"Peristalsis propels contents through GI tract."}
];

// FORCE EXACTLY 100
const QUESTIONS = BASE_QUESTIONS.slice(0, 100);

// hard fail if not exactly 100
if (QUESTIONS.length !== 100) {
  alert("Internal error: test has " + QUESTIONS.length + " questions (should be 100).");
}

const quizEl = document.getElementById("quiz");
const submitBtn = document.getElementById("submitBtn");
const resetBtn = document.getElementById("resetBtn");
const progressPill = document.getElementById("progressPill");
const resultsCard = document.getElementById("resultsCard");
const scoreText = document.getElementById("scoreText");
const breakdownText = document.getElementById("breakdownText");
const missedList = document.getElementById("missedList");

let submitted = false;

function renderQuiz() {
  quizEl.innerHTML = "";
  QUESTIONS.forEach((item, idx) => {
    const card = document.createElement("div");
    card.className = "card";
    card.id = `q${idx+1}`;

    const head = document.createElement("div");
    head.className = "qhead";
    head.innerHTML = `
      <div class="qnum">Q${idx+1}.</div>
      <div class="cat">${escapeHtml(item.category)}</div>
    `;

    const qtext = document.createElement("div");
    qtext.className = "qtext";
    qtext.textContent = item.q;

    const choices = document.createElement("div");
    choices.className = "choices";

    item.choices.forEach((c, cIdx) => {
      const id = `q${idx}_c${cIdx}`;
      const label = document.createElement("label");
      label.className = "choice";
      label.htmlFor = id;
      label.innerHTML = `
        <input type="radio" name="q${idx}" id="${id}" value="${cIdx}" />
        <div>${escapeHtml(c)}</div>
      `;
      choices.appendChild(label);
    });

    const after = document.createElement("div");
    after.className = "after";
    after.id = `after${idx}`;

    card.appendChild(head);
    card.appendChild(qtext);
    card.appendChild(choices);
    card.appendChild(after);
    quizEl.appendChild(card);
  });

  quizEl.addEventListener("change", () => {
    if (!submitted) updateProgress();
  }, { passive: true });
}

function getSelectedIndex(qIndex) {
  const radios = document.querySelectorAll(`input[name="q${qIndex}"]`);
  for (const r of radios) if (r.checked) return Number(r.value);
  return null;
}

function updateProgress() {
  let answered = 0;
  for (let i = 0; i < QUESTIONS.length; i++) if (getSelectedIndex(i) !== null) answered++;
  progressPill.textContent = `Progress: ${answered} / ${QUESTIONS.length} answered`;
}
function scientificExplanation(item) {
  const base = (item.explanation || "").trim();

  const addonByCategory = {
    "Directional terms": "These terms are defined relative to the anatomical position to standardize spatial description.",
    "Planes & cavities": "Anatomical planes are reference slices; body cavities compartmentalize organs and reduce friction/protect structures.",
    "Organization": "Biologic complexity is hierarchical: structure supports function from cellular networks to system-level physiology.",
    "Homeostasis": "Most regulation uses negative feedback loops with sensors, an integrator, and effectors to maintain set points.",
    "Cells": "Cell structures support core functions like gene regulation, protein synthesis, and energy transformation.",
    "Membrane transport": "Transport depends on concentration/electrochemical gradients; active processes require energy to move against gradients.",
    "Cell division": "Mitosis preserves chromosome number for growth/repair, while meiosis creates genetic diversity and reduces ploidy for gametes.",
    "Tissues": "Tissue classification is based on cell type, extracellular matrix, and primary function (barrier, support, contraction, signaling).",
    "Integumentary": "Skin provides barrier function, thermoregulation, sensation, and immune defense via specialized cells and vasculature.",
    "Bone basics": "Bone is a dynamic mineralized connective tissue; its matrix provides strength while permitting remodeling and mineral homeostasis.",
    "Skeleton": "Axial supports the central axis and protects organs; appendicular enables locomotion and manipulation via limb leverage.",
    "Joints": "Joint structure determines degrees of freedom and stability; connective tissues constrain motion and distribute load.",
    "Bone remodeling": "Remodeling couples osteoclast resorption with osteoblast formation to adapt to stress and regulate calcium/phosphate.",
    "Muscle anatomy": "Force is transmitted through connective tissue continuity; attachments convert fiber shortening into joint movement.",
    "Muscle contraction": "Excitation–contraction coupling links membrane depolarization to Ca²⁺ release and actin–myosin cross-bridge cycling.",
    "Muscle types": "Skeletal, cardiac, and smooth muscle differ in control, ultrastructure, and coupling to meet organ-specific demands.",
    "Nervous tissue": "Neurons generate signals; glia regulate extracellular environment, support metabolism, and modulate conduction.",
    "Neuron anatomy": "Polarity matters: dendrites/soma integrate inputs while axons propagate action potentials to targets.",
    "Neurophysiology": "Action potentials reflect voltage-gated ion channel kinetics that change membrane potential over milliseconds.",
    "Synapses": "Synaptic transmission converts electrical signals to chemical signaling (or direct electrical coupling) to control downstream excitability.",
    "CNS": "CNS integrates sensory input and produces coordinated motor/autonomic output via layered networks and tracts.",
    "PNS": "PNS provides communication lines between CNS and tissues, including sensory afferents and motor efferents.",
    "ANS": "Autonomic output adjusts visceral function via sympathetic/parasympathetic tone to maintain internal stability.",
    "Cranial nerves": "Cranial nerves carry specialized sensory and motor/autonomic fibers linking brainstem to head/neck (and some thoracoabdominal).",
    "Endocrine": "Endocrine signaling uses hormones in blood to regulate distant targets; effects depend on receptor type and second messengers.",
    "Hormones": "Hormone action is receptor-mediated; lipid-soluble hormones often alter gene transcription, while peptides act via membrane receptors.",
    "Blood": "Blood supports transport, immunity, and hemostasis; composition and viscosity influence flow and oxygen delivery.",
    "Clotting": "Hemostasis involves platelets plus a coagulation cascade that generates fibrin to stabilize clots.",
    "Heart anatomy": "Cardiac structure supports one-way flow; pressure gradients drive chamber-to-vessel movement across valves.",
    "Cardiac conduction": "Conduction tissue coordinates depolarization timing, optimizing filling and ejection to maintain cardiac output.",
    "Cardiac cycle": "Mechanical phases follow electrical activity; stroke volume depends on preload, afterload, and contractility.",
    "Vessels": "Vessel wall structure (elastic/muscular) determines resistance and compliance, shaping flow and pressure.",
    "Blood pressure": "Arterial pressure reflects cardiac output × systemic vascular resistance, modulated by neural and hormonal control.",
    "Lymphatic": "Lymphatics return interstitial fluid and support antigen surveillance; impaired flow contributes to edema.",
    "Immunity": "Adaptive immunity is antigen-specific with memory; B cells produce antibodies while T cells coordinate/cytotoxic responses.",
    "Respiratory": "Airway anatomy conditions airflow and protects distal gas-exchange surfaces via mucociliary clearance and reflexes.",
    "Breathing mechanics": "Ventilation follows pressure–volume relationships; diaphragm contraction increases thoracic volume and lowers alveolar pressure.",
    "Gas exchange": "Diffusion rate depends on surface area, membrane thickness, and partial pressure gradients (Fick’s law).",
    "Gas transport": "O₂ binds hemoglobin; CO₂ is mainly transported as bicarbonate via carbonic anhydrase chemistry.",
    "Acid-base": "pH is regulated by buffers plus respiratory CO₂ control and renal H⁺/HCO₃⁻ handling.",
    "Digestive": "GI function integrates motility, secretion, and absorption under neural/hormonal control to extract nutrients.",
    "Digestion/absorption": "Absorption is maximized by villi/microvilli and transporters that move solutes with or against gradients.",
    "Liver & bile": "Bile salts emulsify lipids to increase surface area for pancreatic enzymes and micelle formation.",
    "Metabolism": "ATP production depends on substrate availability and oxygen; aerobic pathways yield far more ATP than anaerobic glycolysis.",
    "Urinary": "Urinary anatomy supports filtration, transport, storage, and controlled elimination to maintain internal chemistry.",
    "Nephron": "Nephrons regulate volume/osmolality via filtration, selective reabsorption, and secretion along specialized segments.",
    "Urine formation": "Renal handling is segment-specific; hormones fine-tune transporters to match physiologic needs.",
    "Fluids/electrolytes": "Electrolyte balance controls membrane potentials and osmotic forces; small shifts can affect excitability and rhythm.",
    "Reproduction": "Reproductive physiology is governed by gonadotropins and steroid feedback loops that control gamete production and cycling.",
    "Gametogenesis": "Meiotic recombination and reduction division create haploid gametes and increase genetic variation.",
    "Development": "Early development involves rapid cell division and differentiation guided by gene expression and signaling gradients.",
    "Pregnancy": "Placental exchange and endocrine signaling support fetal growth while maternal systems adapt to higher metabolic demands.",
    "Genetics": "Information flows from DNA → RNA → protein; phenotype reflects gene regulation plus environment.",
    "Inflammation": "Inflammation is a vascular and immune response that recruits leukocytes and mediators to contain injury/pathogens.",
    "Infection": "Pathogens cause disease via invasion, toxin production, or immune dysregulation; host defenses determine severity.",
    "Shock": "Shock is a state of inadequate cellular oxygen delivery/utilization leading to anaerobic metabolism and lactic acidosis.",
    "Trauma": "Trauma physiology often centers on hemorrhage, hypoxia, and inflammation; rapid control prevents secondary injury cascades.",
    "Aging": "Aging reflects cumulative cellular damage and reduced physiologic reserve, lowering tolerance to stressors."
  };

  const addon = addonByCategory[item.category] || "Mechanistically, focus on structure–function relationships and the physiologic variables being regulated.";

  // Keep it short-ish: base + 1 extra sentence
  if (!base) return addon;
  return base.endsWith(".") ? `${base} ${addon}` : `${base}. ${addon}`;
}

function submitQuiz() {
  if (submitted) return;
  submitted = true;

  let correct = 0, incorrect = 0, unanswered = 0;
  missedList.innerHTML = "";

  QUESTIONS.forEach((item, idx) => {
    const selected = getSelectedIndex(idx);
    const after = document.getElementById(`after${idx}`);
    after.style.display = "block";

    let statusText = "", statusClass = "";
    if (selected === null) {
      unanswered++;
      statusText = "Unanswered (counted incorrect)";
      statusClass = "bad";
      addMissed(idx, "Unanswered");
    } else if (selected === item.answerIndex) {
      correct++;
      statusText = "Correct";
      statusClass = "good";
    } else {
      incorrect++;
      statusText = "Incorrect";
      statusClass = "bad";
      addMissed(idx, `Chose ${letter(selected)}; correct is ${letter(item.answerIndex)}`);
    }

    after.innerHTML = `
      <div class="status ${statusClass}">${statusText}</div>
      <div class="explain">
        Correct answer: <span class="correct">${letter(item.answerIndex)}.</span> ${escapeHtml(item.choices[item.answerIndex])}
        <div style="margin-top:6px;">Explanation: ${escapeHtml(scientificExplanation(item))}</div>

      </div>
    `;

    document.querySelectorAll(`input[name="q${idx}"]`).forEach(r => r.disabled = true);
  });

  scoreText.textContent = `${correct}`;
  breakdownText.textContent = `Correct: ${correct} • Incorrect: ${incorrect} • Unanswered: ${unanswered} • Total incorrect: ${incorrect + unanswered}`;
  resultsCard.style.display = "block";
  progressPill.textContent = `Submitted: ${QUESTIONS.length} questions graded`;
  submitBtn.disabled = true;
}

function addMissed(idx, note) {
  const li = document.createElement("li");
  li.innerHTML = `<a href="#q${idx+1}" style="color:#9fb0ff; text-decoration:none;">Q${idx+1}</a> — ${escapeHtml(note)}`;
  missedList.appendChild(li);
}

function resetQuiz() {
  submitted = false;
  submitBtn.disabled = false;
  resultsCard.style.display = "none";
  renderQuiz();
  updateProgress();
  window.scrollTo({ top: 0, behavior: "smooth" });
}

function letter(i){ return ["A","B","C","D"][i] ?? "?"; }
function escapeHtml(str) {
  return String(str)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

submitBtn.addEventListener("click", submitQuiz);
resetBtn.addEventListener("click", resetQuiz);

renderQuiz();
updateProgress();
</script>
</body>
</html>
